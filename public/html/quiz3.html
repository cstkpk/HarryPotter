<!DOCTYPE html>
<html lang="en-us">
    
<head>
    <meta charset="UTF-8">
    <title>Favorite Class</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <!-- jQuery -->
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <!-- Compiled and minified CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">
    <!-- Compiled and minified JavaScript -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
    <!-- Font Awesome icons -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.1/css/font-awesome.min.css">
    <!-- Custom CSS -->
    <link rel="stylesheet" href="../styles/quizstyle.css">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css?family=Beth+Ellen&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Homemade+Apple&display=swap" rel="stylesheet">
</head>

<body>

    <div class="row">
        <div class="col m12">
            <div class="card z-depth-3 quiz-card">
                <div class="card-content white-text">
                    <h1 class="center-align quiz-title">What is your favorite class?</h1>
                </div>
            </div>
        </div>
    </div>

    <div class="container">
        
        <form>
            <!-- Question 1 -->
            <label for="q1" class="question">Would you rather:</label><br>
            <div id="q1">
                <p>
                    <label>
                        <input value="1" class="with-gap" name="group1" type="radio"/>
                        <span id="poss-answers"><a href="#" class="effect-shine">Look for shapes in the clouds and stars</a></span>
                    </label>
                </p>
                <p>
                    <label>
                        <input value="2" class="with-gap" name="group1" type="radio"/>
                        <span id="poss-answers"><a href="#" class="effect-shine">Read a novel</a></span>
                    </label>
                </p>
                <p>
                    <label>
                        <input value="3" class="with-gap" name="group1" type="radio"/>
                        <span id="poss-answers"><a href="#" class="effect-shine">Wander through a forest</a></span>
                    </label>
                </p>
                <p>
                    <label>
                        <input value="4" class="with-gap" name="group1" type="radio"/>
                        <span id="poss-answers"><a href="#" class="effect-shine">Play with firecrackers</a></span>
                    </label>
                </p>
            </div>
            <!-- Question 2 -->
            <label for="q2" class="question">You reach a fork in the road. Do you:</label><br>
            <div id="q2">
                <p>
                    <label>
                        <input value="1" class="with-gap" name="group2" type="radio"/>
                        <span id="poss-answers"><a href="#" class="effect-shine">Take the beaten path</a></span>
                    </label>
                </p>
                <p>
                    <label>
                        <input value="2" class="with-gap" name="group2" type="radio"/>
                        <span id="poss-answers"><a href="#" class="effect-shine">Take the road less traveled</a></span>
                    </label>
                </p>
                <p>
                    <label>
                        <input value="3" class="with-gap" name="group2" type="radio"/>
                        <span id="poss-answers"><a href="#" class="effect-shine">Break off the path, forging your own trail</a></span>
                    </label>
                </p>
                <p>
                    <label>
                        <input value="4" class="with-gap" name="group2" type="radio"/>
                        <span id="poss-answers"><a href="#" class="effect-shine">Turn around and go home</a></span>
                    </label>
                </p>
            </div>
            <!-- Question 3 -->
            <label for="q3" class="question">What frustrates you the most?</label><br>
            <div id="q3">
                <p>
                    <label>
                        <input value="1" class="with-gap" name="group3" type="radio"/>
                        <span id="poss-answers"><a href="#" class="effect-shine">When Nearly Headless Nick does that thing with his head</a></span>
                    </label>
                </p>
                <p>
                    <label>
                        <input value="2" class="with-gap" name="group3" type="radio"/>
                        <span id="poss-answers"><a href="#" class="effect-shine">When Professor Snape taunts you in front of the whole class</a></span>
                    </label>
                </p>
                <p>
                    <label>
                        <input value="3" class="with-gap" name="group3" type="radio"/>
                        <span id="poss-answers"><a href="#" class="effect-shine">When Filch blames you for getting lost when the staircases move</a></span>
                    </label>
                </p>
                <p>
                    <label>
                        <input value="4" class="with-gap" name="group3" type="radio"/>
                        <span id="poss-answers"><a href="#" class="effect-shine">When your grandmother sends you a Remembrall and it turns red but you can't remember what you've forgotten</a></span>
                    </label>
                </p>
            </div>
            <!-- Question 4 -->
            <label for="q4" class="question">Where do you go first in Diagon Alley?</label><br>
            <div id="q4">
                <p>
                    <label>
                        <input value="1" class="with-gap" name="group4" type="radio"/>
                        <span id="poss-answers"><a href="#" class="effect-shine">Florean Fortescue's Ice Cream Parlor</a></span>
                    </label>
                </p>
                <p>
                    <label>
                        <input value="2" class="with-gap" name="group4" type="radio"/>
                        <span id="poss-answers"><a href="#" class="effect-shine">Florish and Blotts</a></span>
                    </label>
                </p>
                <p>
                    <label>
                        <input value="3" class="with-gap" name="group4" type="radio"/>
                        <span id="poss-answers"><a href="#" class="effect-shine">Slug and Jiggers Apothecary</a></span>
                    </label>
                </p>
                <p>
                    <label>
                        <input value="4" class="with-gap" name="group4" type="radio"/>
                        <span id="poss-answers"><a href="#" class="effect-shine">Olivander's Wand Shop</a></span>
                    </label>
                </p>
            </div>
            <!-- Quesiton 5 -->
            <label for="q5" class="question">Which muggle subject are you best at?</label><br>
            <div id="q5">
                <p>
                    <label>
                        <input value="1" class="with-gap" name="group5" type="radio"/>
                        <span id="poss-answers"><a href="#" class="effect-shine">Math</a></span>
                    </label>
                </p>
                <p>
                    <label>
                        <input value="2" class="with-gap" name="group5" type="radio"/>
                        <span id="poss-answers"><a href="#" class="effect-shine">Arts</a></span>
                    </label>
                </p>
                <p>
                    <label>
                        <input value="3" class="with-gap" name="group5" type="radio"/>
                        <span id="poss-answers"><a href="#" class="effect-shine">Science</a></span>
                    </label>
                </p>
                <p>
                    <label>
                        <input value="4" class="with-gap" name="group5" type="radio"/>
                        <span id="poss-answers"><a href="#" class="effect-shine">Writing</a></span>
                    </label>
                </p>
            </div>
            <!-- Question 6 -->
            <label for="q6" class="question">A muggle has discovered that you're a wizard! What do you do?</label><br>
            <div id="q6">
                <p>
                    <label>
                        <input value="1" class="with-gap" name="group6" type="radio"/>
                        <span id="poss-answers"><a href="#" class="effect-shine">Wipe his memory. Obliviate!</a></span>
                    </label>
                </p>
                <p>
                    <label>
                        <input value="2" class="with-gap" name="group6" type="radio"/>
                        <span id="poss-answers"><a href="#" class="effect-shine">Talk with him over a drink... and become his new best friend!</a></span>
                    </label>
                </p>
                <p>
                    <label>
                        <input value="3" class="with-gap" name="group6" type="radio"/>
                        <span id="poss-answers"><a href="#" class="effect-shine">Tell everyone that he's crazy.</a></span>
                    </label>
                </p>
                <p>
                    <label>
                        <input value="4" class="with-gap" name="group6" type="radio"/>
                        <span id="poss-answers"><a href="#" class="effect-shine">Cast an illusion to make him think he saw something else.</a></span>
                    </label>
                </p>
            </div>
            <!-- Quesiton 7 -->
            <label for="q7" class="question">Watch out! Hogwarts is under attack. What do you bring to the battle?</label><br>
            <div id="q7">
                <p>
                    <label>
                        <input value="1" class="with-gap" name="group7" type="radio"/>
                        <span id="poss-answers"><a href="#" class="effect-shine">All you need is your wand.</a></span>
                    </label>
                </p>
                <p>
                    <label>
                        <input value="2" class="with-gap" name="group7" type="radio"/>
                        <span id="poss-answers"><a href="#" class="effect-shine">Some poisonous plants and potions.</a></span>
                    </label>
                </p>
                <p>
                    <label>
                        <input value="3" class="with-gap" name="group7" type="radio"/>
                        <span id="poss-answers"><a href="#" class="effect-shine">A broomstick and a wand.</a></span>
                    </label>
                </p>
                <p>
                    <label>
                        <input value="4" class="with-gap" name="group7" type="radio"/>
                        <span id="poss-answers"><a href="#" class="effect-shine">Your extensive knowledge of the layout of Hogwarts.</a></span>
                    </label>
                </p>
            </div>
            <!-- Question 8 -->
            <label for="q8" class="question">What is your preferred mode of transportation?</label><br>
            <div id="q8">
                <p>
                    <label>
                        <input value="1" class="with-gap" name="group8" type="radio"/>
                        <span id="poss-answers"><a href="#" class="effect-shine">Hippogriffs</a></span>
                    </label>
                </p>
                <p>
                    <label>
                        <input value="2" class="with-gap" name="group8" type="radio"/>
                        <span id="poss-answers"><a href="#" class="effect-shine">Trains</a></span>
                    </label>
                </p>
                <p>
                    <label>
                        <input value="3" class="with-gap" name="group8" type="radio"/>
                        <span id="poss-answers"><a href="#" class="effect-shine">Flying cars</a></span>
                    </label>
                </p>
                <p>
                    <label>
                        <input value="4" class="with-gap" name="group8" type="radio"/>
                        <span id="poss-answers"><a href="#" class="effect-shine">Broomsticks</a></span>
                    </label>
                </p>
            </div>
            <!-- Question 9 -->
            <label for="q9" class="question">You're baking a batch of enchanted brownies. What secret ingredient do you put the Sleeping Draught in?</label><br>
            <div id="q9">
                <p>
                    <label>
                        <input value="1" class="with-gap" name="group9" type="radio"/>
                        <span id="poss-answers"><a href="#" class="effect-shine">Walnuts</a></span>
                    </label>
                </p>
                <p>
                    <label>
                        <input value="2" class="with-gap" name="group9" type="radio"/>
                        <span id="poss-answers"><a href="#" class="effect-shine">Marshmallows</a></span>
                    </label>
                </p>
                <p>
                    <label>
                        <input value="3" class="with-gap" name="group9" type="radio"/>
                        <span id="poss-answers"><a href="#" class="effect-shine">Pretzles</a></span>
                    </label>
                </p>
                <p>
                    <label>
                        <input value="4" class="with-gap" name="group9" type="radio"/>
                        <span id="poss-answers"><a href="#" class="effect-shine">Caramel</a></span>
                    </label>
                </p>
            </div>
            <!-- Question 10 -->
            <label for="q10" class="question">You're walking through a forest and hear a branch snap behind you. You turn around and see a ferocious troll! What do you do?</label><br>
            <div id="q10">
                <p>
                    <label>
                        <input value="1" class="with-gap" name="group10" type="radio"/>
                        <span id="poss-answers"><a href="#" class="effect-shine">Turn around and run!</a></span>
                    </label>
                </p>
                <p>
                    <label>
                        <input value="2" class="with-gap" name="group10" type="radio"/>
                        <span id="poss-answers"><a href="#" class="effect-shine">Climb up his back for an epic piggy back ride.</a></span>
                    </label>
                </p>
                <p>
                    <label>
                        <input value="3" class="with-gap" name="group10" type="radio"/>
                        <span id="poss-answers"><a href="#" class="effect-shine">Tell the troll jokes in an attempt to befriend him.</a></span>
                    </label>
                </p>
                <p>
                    <label>
                        <input value="4" class="with-gap" name="group10" type="radio"/>
                        <span id="poss-answers"><a href="#" class="effect-shine">Challenge him to a duel.</a></span>
                    </label>
                </p>
            </div>
            <br>
            <button class="btn waves-effect waves-light brown darken-2" id="submit" type="submit"> Submit</button>
        </form>
        <br>

        <!-- Form validation modal -->
        <div id="modal1" class="modal">
            <div class="modal-content">
                <h4 class="center-align modalv">Locomotor Mortis!</h4>
                <br><br>
                <p class="center-align modalv">Please answer all of the questions.</p>
            </div>
            <div class="modal-footer" id="modal1-footer">
                <a href="#!" class="modal-close waves-effect waves-brown btn-flat modalv">Got it!</a>
            </div>
        </div>
        <!-- Match modal -->
        <div class="modal" id="modal-match">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="center-align modalm">Your favorite class is...</h4>
                </div>
                <div class="modal-body">
                    <p class="center-align modalm"><span id="match-name"></a></span>!</p>
                    <img class="responsive-img center-align" id="match-photo" src="" alt="">
                </div>
            </div>
            <div class="center-align modal-footer">
                <a href="#" id="results-btn" class="modal-close waves-effect waves-brown btn-flat modalm">Show me my results!</a>
            </div>
        </div>
        

    </div>

    <audio id="class-noise">
        <source src="../audio/class-noise.mp3" type="audio/mpeg">
    </audio>    


<script type="text/javascript">

// Retrieve user input
var playerID = sessionStorage.getItem("playerID");
console.log(playerID);

$("#submit").on("click", function(event) {
    var answerArr = [];
    var userAnswers = {};
    event.preventDefault();
    // Form validation
    function validateForm() {
        var isValid = true;

        userAnswers = {
          hello: ["hello"],
          options: [
            $("#q1 input:checked").val(),
            $("#q2 input:checked").val(),
            $("#q3 input:checked").val(),
            $("#q4 input:checked").val(),
            $("#q5 input:checked").val(),
            $("#q6 input:checked").val(),
            $("#q7 input:checked").val(),
            $("#q8 input:checked").val(),
            $("#q9 input:checked").val(),
            $("#q10 input:checked").val()
          ]
        };
        console.log("GOODBYE");
        console.log(userAnswers);
        
        userAnswers.options.map(i=>{
            if($(`#q${i} input:checked`)){
                answerArr.push(i)
            } 
            if (answerArr.includes(undefined)) {
                isValid = false;
            }
        })
        console.log(answerArr);
        console.log("Form validation finished");
        return isValid;
    }
    
    // If form validation returns as true, create an object to hold user's input
    if (validateForm()) {
        console.log("HELLO");
        console.log(userAnswers);
        $("audio#class-noise")[0].play();

        // Post user input to /api/players
        $.ajax({
            method: "PUT",
            url: "/api/players/class",
            data: {userAnswers, playerID}
        })
        .then(function(data){
            // Grab match here
            $("#match-name").text(data.className);
            $("#match-photo").attr("src", data.classImage);
            // Show results modal
            $("#modal-match").modal({
                dismissible: false
            });
            $("#modal-match").modal("open");
            console.log("Front end hello!");
        })
    } 
    // If form validation returns as false, tell the user to fill out all of the questions
    else {
        $("#modal1").modal();
        $("#modal1").modal("open");
    }
});

$("#results-btn").on("click", function() {
    window.location.href = "/results/" + playerID
});

// $("#q1 input").on("click", function() {
//     console.log($("#q1 input:checked").val());
// })

</script>

</body>

</html>