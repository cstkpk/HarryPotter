<!DOCTYPE html>
<html lang="en-us">
    
<head>
    <meta charset="UTF-8">
    <title>Friend Finder</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <!-- jQuery -->
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <!-- Compiled and minified CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">
    <!-- Compiled and minified JavaScript -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
    <!-- Font Awesome icons -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.1/css/font-awesome.min.css">
    <!-- Custom CSS -->
    <!-- <link rel="stylesheet" href="assets/css/style.css"> -->
</head>

<body>

    <div class="container">

        <h1>Which house are you in!?!?!?!?</h1>
        <hr>

        <!-- <div class="row">
            <div class="col"
        </div> -->
        
        <form>
             <h3>Question 1</h3>
            <label for="q1">Where are you most likely to be found on a Saturday night?</label><br>
            <div id="q1">
                <p>
                    <label>
                        <input value="2" class="with-gap" name="group1" type="radio"/>
                        <span>Studying for upcoming exams</span>
                    </label>
                </p>
                <p>
                    <label>
                        <input value="4" class="with-gap" name="group1" type="radio"/>
                        <span>Hiding stink bombs in the girl's dormitories</span>
                    </label>
                </p>
                <p>
                    <label>
                        <input value="1" class="with-gap" name="group1" type="radio"/>
                        <span>Sneaking into the Enchanted Forest on a dare</span>
                    </label>
                </p>
                <p>
                    <label>
                        <input value="3" class="with-gap" name="group1" type="radio"/>
                        <span>Drinking Butterbeer with your friends</span>
                    </label>
                </p>
            </div>
            <h3>Question 2</h3>
            <label for="q2">Which pet would you like as your companion</label><br>
            <div id="q2">
                <p>
                    <label>
                        <input value="1" class="with-gap" name="group2" type="radio"/>
                        <span>A Cat</span>
                    </label>
                </p>
                <p>
                    <label>
                        <input value="3" class="with-gap" name="group2" type="radio"/>
                        <span>A Rabbit</span>
                    </label>
                </p>
                <p>
                    <label>
                        <input value="4" class="with-gap" name="group2" type="radio"/>
                        <span>A Snake</span>
                    </label>
                </p>
                <p>
                    <label>
                        <input value="2" class="with-gap" name="group2" type="radio"/>
                        <span>A Crow</span>
                    </label>
                </p>
            </div>
            <h3>Question 3</h3>
            <label for="q3">Which class are you most looking forward to?</label><br>
            <div id="q3">
                <p>
                    <label>
                        <input value="1" class="with-gap" name="group3" type="radio"/>
                        <span>Defense Against the Dark Arts</span>
                    </label>
                </p>
                <p>
                    <label>
                        <input value="2" class="with-gap" name="group3" type="radio"/>
                        <span>History of Magic</span>
                    </label>
                </p>
                <p>
                    <label>
                        <input value="4" class="with-gap" name="group3" type="radio"/>
                        <span>Potions</span>
                    </label>
                </p>
                <p>
                    <label>
                        <input value="3" class="with-gap" name="group3" type="radio"/>
                        <span>Charms</span>
                    </label>
                </p>
            </div>
            <h3>Question 4</h3>
            <label for="q4">You notice someone cheating on their O.W.L.s by using an Auto-Answer Quill. Do you:</label><br>
            <div id="q4">
                <p>
                    <label>
                        <input value="1" class="with-gap" name="group4" type="radio"/>
                        <span>Ignore them. You have your own test to worry about.</span>
                    </label>
                </p>
                <p>
                    <label>
                        <input value="4" class="with-gap" name="group4" type="radio"/>
                        <span>Lean over and copy their answers for an easy "O" score.</span>
                    </label>
                </p>
                <p>
                    <label>
                        <input value="2" class="with-gap" name="group4" type="radio"/>
                        <span>Wave down a professor.</span>
                    </label>
                </p>
                <p>
                    <label>
                        <input value="3" class="with-gap" name="group4" type="radio"/>
                        <span>Talk to them after and try to help them change</span>
                    </label>
                </p>
            </div>
            <h3>Question 5</h3>
            <label for="q5">You are wandering the halls of Hogwarts at night and stumble upon the Mirror of Erised. What do you see?</label><br>
            <div id="q5">
                <p>
                    <label>
                        <input value="4" class="with-gap" name="group5" type="radio"/>
                        <span>Yourself surrounded by piles of Galleons</span>
                    </label>
                </p>
                <p>
                    <label>
                        <input value="3" class="with-gap" name="group5" type="radio"/>
                        <span>A party with your closest friends</span>
                    </label>
                </p>
                <p>
                    <label>
                        <input value="1" class="with-gap" name="group5" type="radio"/>
                        <span>An older version of yourself with your loving family</span>
                    </label>
                </p>
                <p>
                    <label>
                        <input value="2" class="with-gap" name="group5" type="radio"/>
                        <span>Yourself reading a book in your private library</span>
                    </label>
                </p>
            </div>
            <h3>Question 6</h3>
            <label for="q6">You notice a group of Fifth Years picking on a First Year. What do you do?</label><br>
            <div id="q6">
                <p>
                    <label>
                        <input value="1" class="with-gap" name="group6" type="radio"/>
                        <span>Step in between them, breaking it up</span>
                    </label>
                </p>
                <p>
                    <label>
                        <input value="4" class="with-gap" name="group6" type="radio"/>
                        <span>Join in the fun, First Years need to be put in their place</span>
                    </label>
                </p>
                <p>
                    <label>
                        <input value="2" class="with-gap" name="group6" type="radio"/>
                        <span>Find a professor to help</span>
                    </label>
                </p>
                <p>
                    <label>
                        <input value="2" class="with-gap" name="group6" type="radio"/>
                        <span>Seek out the First Year later and try to console them</span>
                    </label>
                </p>
            </div>
            <h3>Question 7</h3>
            <label for="q7">A fire has broken out in your home and you can only save one thing. What do you take?</label><br>
            <div id="q7">
                <p>
                    <label>
                        <input value="1" class="with-gap" name="group7" type="radio"/>
                        <span>Your pet</span>
                    </label>
                </p>
                <p>
                    <label>
                        <input value="2" class="with-gap" name="group7" type="radio"/>
                        <span>Your favorite book</span>
                    </label>
                </p>
                <p>
                    <label>
                        <input value="3" class="with-gap" name="group7" type="radio"/>
                        <span>Your family photo album</span>
                    </label>
                </p>
                <p>
                    <label>
                        <input value="4" class="with-gap" name="group7" type="radio"/>
                        <span>Your lockbox containing valuables</span>
                    </label>
                </p>
            </div>
            <h3>Question 8</h3>
            <label for="q8">It's Hogsmeade weekend. Where do you and your friends go?</label><br>
            <div id="q8">
                <p>
                    <label>
                        <input value="4" class="with-gap" name="group8" type="radio"/>
                        <span>The Shrieking Shack to try and find a way inside</span>
                    </label>
                </p>
                <p>
                    <label>
                        <input value="1" class="with-gap" name="group8" type="radio"/>
                        <span>Honeydukes to relax with some friends</span>
                    </label>
                </p>
                <p>
                    <label>
                        <input value="2" class="with-gap" name="group8" type="radio"/>
                        <span>Tomes and Scrolls for some new books</span>
                    </label>
                </p>
                <p>
                    <label>
                        <input value="3" class="with-gap" name="group8" type="radio"/>
                        <span>Zonko's Joke Shop for some gag gifts</span>
                    </label>
                </p>
            </div>
            <h3>Question 9</h3>
            <label for="q9">You find yourself in a duel with a rival wizard. What is the first spell you cast?</label><br>
            <div id="q9">
                <p>
                    <label>
                        <input value="1" class="with-gap" name="group9" type="radio"/>
                        <span>Expelliarmus</span>
                    </label>
                </p>
                <p>
                    <label>
                        <input value="3" class="with-gap" name="group9" type="radio"/>
                        <span>A Bat-Bogey Hex</span>
                    </label>
                </p>
                <p>
                    <label>
                        <input value="4" class="with-gap" name="group9" type="radio"/>
                        <span>Crucio</span>
                    </label>
                </p>
                <p>
                    <label>
                        <input value="2" class="with-gap" name="group9" type="radio"/>
                        <span>Full Body-Bind Curse</span>
                    </label>
                </p>
            </div>
            <h3>Question 10</h3>
            <label for="q10">What position do you play on the Quidditch team?</label><br>
            <div id="q10">
                <p>
                    <label>
                        <input value="1" class="with-gap" name="group10" type="radio"/>
                        <span>Seeker</span>
                    </label>
                </p>
                <p>
                    <label>
                        <input value="4" class="with-gap" name="group10" type="radio"/>
                        <span>Beater</span>
                    </label>
                </p>
                <p>
                    <label>
                        <input value="2" class="with-gap" name="group10" type="radio"/>
                        <span>Chaser</span>
                    </label>
                </p>
                <p>
                    <label>
                        <input value="3" class="with-gap" name="group10" type="radio"/>
                        <span>Keeper</span>
                    </label>
                </p>
            </div>
            <br><br>
            <button class="btn btn-primary" id="submit" type="submit"><i class="fa fa-check-circle"></i> Submit form</button>
        </form>

        <hr>
        <footer class="footer">
            <div class="container">
              <p>
                <a href="/api/friends">API Friends List</a> |
                <a href="https://github.com/cstkpk/Friend-Finder" target="_blank">Github Repo</a>
            </div>
        </footer>

        <!-- Form validation modal -->
        <div id="modal1" class="modal">
            <div class="modal-content">
                <h4>Hey there!</h4>
                <p>This contact form is not yet functional, but check back soon!</p>
            </div>
            <div class="modal-footer">
                <a href="#!" class="modal-close waves-effect waves-green btn-flat">Got it!</a>
            </div>
        </div>
        <!-- Match modal -->
        <div class="modal" id="modal-match">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Results</h5>
                </div>
                <div class="modal-body">
                    <p>You've been sorted into: <span id="match-name"></span></p>
                    <img class="responsive-img" id="match-photo" src="" alt="">
                </div>
            </div>
            <div class="modal-footer">
                <a href="/pause" class="modal-close waves-effect waves-green btn-flat">Continue!</a>
            </div>
        </div>
        

    </div>


<script type="text/javascript">
    
var playerName = JSON.parse(sessionStorage.getItem("playerName"));
console.log(playerName);

// Retrieve user input
$("#submit").on("click", function(event) {
    var answerArr = [];
    var userAnswers = {};
    event.preventDefault();
    // Form validation
    function validateForm() {
        var isValid = true;

        userAnswers = {
          hello: ["hello"],
          options: [
            $("#q1 input:checked").val(),
            $("#q2 input:checked").val(),
            $("#q3 input:checked").val(),
            $("#q4 input:checked").val(),
            $("#q5 input:checked").val(),
            $("#q6 input:checked").val(),
            $("#q7 input:checked").val(),
            $("#q8 input:checked").val(),
            $("#q9 input:checked").val(),
            $("#q10 input:checked").val()
          ]
        };
        console.log("GOODBYE");
        console.log(userAnswers);
        
        userAnswers.options.map(i=>{
            if($(`#q${i} input:checked`)){
                answerArr.push(i)
            } 
            if (answerArr.includes(undefined)) {
                isValid = false;
            }
        })
        console.log(answerArr);
        console.log("Form validation finished");
        return isValid;
    }
    
    // If form validation returns as true, create an object to hold user's input
    if (validateForm()) {
        // var userAnswers = {
        //   options: [
        //     $("#q1 input:checked").val(),
        //     $("#q2 input:checked").val(),
        //     $("#q3 input:checked").val(),
        //     $("#q4 input:checked").val(),
        //     $("#q5 input:checked").val(),
        //     $("#q6 input:checked").val(),
        //     $("#q7 input:checked").val(),
        //     $("#q8 input:checked").val(),
        //     $("#q9 input:checked").val(),
        //     $("#q10 input:checked").val()
        //   ]
        // };
        console.log("HELLO");
        console.log(userAnswers);

        // Post user input to /api/players
        $.ajax({
            method: "PUT",
            url: "/api/players",
            data: {userAnswers, playerName}
        })
        .then(function(data){
            // Grab match here
            $("#match-name").text(data.houseName);
            $("#match-photo").attr("src", data.houseImage)
            // Show results modal
            $("#modal-match").modal();
            $("#modal-match").modal("open");
            console.log("Front end hello!");
        }).then(() => {  
            $.post("/results", playerName, function(data) {
                console.log(playerName);
            })
        })
        // .then(() => {
        //     window.location.href = "/results"
        // });
    
    } 
    // If form validation returns as false, tell the user to fill out all of the questions
    else {
        $(".modal").modal();
        $(".modal").modal("open");
    }
});

$("#q1 input").on("click", function() {
    // console.log($("input.a1").val());
    // console.log($("input.a2").val());
    console.log($("#q1 input:checked").val());
})

</script>

</body>

</html>